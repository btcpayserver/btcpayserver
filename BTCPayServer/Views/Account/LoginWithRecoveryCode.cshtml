@model LoginWithRecoveryCodeViewModel
@{
    ViewData["Title"] = "Recovery code verification";
}


<section>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 section-heading">
                <h2>@ViewData["Title"]</h2>
                <hr class="primary">
                <p>
                    You have requested to login with a login or recovery code. This login will not be remembered. You can find a login code in your Account > Login Codes page when logged in.
                </p>
            </div>
        </div>
        <div class="row">
            <form method="post" class="col-12" id="recovery-code-form">
                <div asp-validation-summary="All" class="text-danger"></div>


                <div class="form-group">

                    <label asp-for="RecoveryCode" class="form-label"></label>
                    <div class="input-group  d-flex">
                        <input asp-for="RecoveryCode" class="form-control" autocomplete="off"/>
                        <div class="input-group-append">
                            <button type="button" id="scanqrcode" class="btn btn-secondary only-for-js" data-bs-toggle="modal" data-bs-target="#scanModal"  title="Scan with camera">
                                <i class="fa fa-camera"></i>
                            </button>
                        </div>
                    </div>
                    <span asp-validation-for="RecoveryCode" class="text-danger"></span>
                </div>

                <button type="submit" class="btn btn-primary">Log in</button>
            </form>
        </div>
    </div>
</section>

<partial name="CameraScanner"/>

@section PageFootContent {
    <partial name="_ValidationScriptsPartial"/>

    <bundle name="wwwroot/bundles/camera-bundle.min.js"></bundle>
    <link href="~/vendor/vue-qrcode-reader/vue-qrcode-reader.css" rel="stylesheet" asp-append-version="true"/>

    <script type="text/javascript">
        window.addEventListener("load", async () => {
            initCameraScanningApp("Scan login code", data => {
                document.getElementById("RecoveryCode").value = data;
                document.getElementById("recovery-code-form").submit();
            }, "scanModal");
        });
    </script>
}

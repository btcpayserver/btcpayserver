@model WalletSigningOptionsModel
@inject BTCPayNetworkProvider BTCPayNetworkProvider
@addTagHelper *, BundlerMinifier.TagHelpers
@{
    Layout = "_LayoutWizard";
    ViewData.SetActivePageAndTitle(WalletsNavPages.Send, "Sign the transaction", Context.GetStoreData().StoreName);
    var walletId = WalletId.Parse(Context.GetRouteValue("walletId").ToString());
}

@section Navbar {
    <a asp-all-route-data="Model.RouteDataBack">
        <vc:icon symbol="back" />
    </a>
    <a asp-all-route-data="Model.RouteDataBack" class="cancel">
        <vc:icon symbol="close" />
    </a>
}

<header class="text-center">
    <h1>Choose your signing method</h1>
    <p class="lead text-secondary mt-3">You can sign the transaction using one of the following methods.</p>
</header>

<form method="post" asp-all-route-data="Model.RouteDataForm">
    <partial name="SigningContext" for="SigningContext" />

    @if (BTCPayNetworkProvider.GetNetwork<BTCPayNetwork>(walletId.CryptoCode).VaultSupported)
    {
        <div class="list-group mt-4">
            <button type="submit" name="command" value="vault" class="list-group-item list-group-item-action only-for-js" id="SignWithVault">
                <div class="image">
                    <vc:icon symbol="hardware-wallet"/>
                </div>
                <div class="content d-flex flex-column flex-lg-row align-items-lg-center justify-content-lg-between me-2">
                    <div>
                        <h4>Hardware wallet</h4>
                        <p class="mb-0 text-secondary">Sign using our Vault application</p>
                    </div>
                    <small class="d-block text-primary mt-2 mt-lg-0">Recommended</small>
                </div>
                <vc:icon symbol="caret-right"/>
            </button>
            <noscript>
                <div class="list-group-item disabled">
                    <div class="image">
                        <vc:icon symbol="hardware-wallet"/>
                    </div>
                    <div class="content d-flex flex-column flex-lg-row align-items-lg-center justify-content-lg-between me-2">
                        <div><h4>Hardware wallet</h4>
                            <p class="mb-0">Please enable JavaScript for this option to be available</p>
                        </div>
                    </div>
                </div>
            </noscript>
        </div>
    }

    <div class="list-group mt-4">
        <button type="submit" name="command" value="seed" class="list-group-item list-group-item-action" id="SignWithSeed">
            <div class="image">
                <vc:icon symbol="seed"/>
            </div>
            <div class="content d-flex flex-column flex-lg-row align-items-lg-center justify-content-lg-between me-2">
                <div>
                    <h4>HD private key or mnemonic seed</h4>
                    <p class="mb-0 text-secondary">Provide the 12 or 24 word recovery seed</p>
                </div>
                <small class="d-block text-danger mt-2 mt-lg-0" data-bs-toggle="tooltip" data-bs-placement="top" title="You really should not type your seed into a device that is connected to the internet.">Not recommended <span class="fa fa-question-circle-o"></span></small>
            </div>
            <vc:icon symbol="caret-right"/>
        </button>
    </div>

    <div class="list-group mt-4">
        <button type="submit" name="command" value="analyze-psbt" class="list-group-item list-group-item-action" id="SignWithPSBT">
            <div class="image">
                <vc:icon symbol="psbt"/>
            </div>
            <div class="content">
                <h4>PSBT</h4>
                <p class="mb-0 text-secondary">Sign using a wallet supporting partially signed bitcoin transactions</p>
            </div>
            <vc:icon symbol="caret-right"/>
        </button>
    </div>

    @if (Model.SigningContext.NBXSeedAvailable)
    {
        <div class="list-group mt-4">
            <button type="submit" name="command" value="nbx-seed" class="list-group-item list-group-item-action" id="SignWithNBxplorer">
                <div class="image">
                    <vc:icon symbol="hot-wallet"/>
                </div>
                <div class="content">
                    <h4>Hot Wallet</h4>
                    <p class="mb-0 text-secondary">Use the hot wallet for signing</p>
                </div>
                <vc:icon symbol="caret-right"/>
            </button>
        </div>
    }
</form>
